"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[551],{1470:(e,n,t)=>{t.d(n,{A:()=>S});var i=t(6540),s=t(4164),r=t(7559),a=t(3104),l=t(6347),o=t(205),d=t(7485),c=t(1682),h=t(679);function u(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,i.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:t,default:i}})=>({value:e,label:n,attributes:t,default:i}))}(t);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function m({value:e,tabValues:n}){return n.some(n=>n.value===e)}function x({queryString:e=!1,groupId:n}){const t=(0,l.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,d.aZ)(s),(0,i.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function v(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,r=p(e),[a,l]=(0,i.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r})),[d,c]=x({queryString:t,groupId:s}),[u,v]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,h.Dv)(n);return[t,(0,i.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),j=(()=>{const e=d??u;return m({value:e,tabValues:r})?e:null})();(0,o.A)(()=>{j&&l(j)},[j]);return{selectedValue:a,selectValue:(0,i.useCallback)(e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),c(e),v(e)},[c,v,r]),tabValues:r}}var j=t(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=t(4848);function b({className:e,block:n,selectedValue:t,selectValue:i,tabValues:r}){const l=[],{blockElementScrollPositionUntilNextRender:o}=(0,a.a_)(),d=e=>{const n=e.currentTarget,s=l.indexOf(n),a=r[s].value;a!==t&&(o(n),i(a))},c=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:r.map(({value:e,label:n,attributes:i})=>(0,g.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{l.push(e)},onKeyDown:c,onClick:d,...i,className:(0,s.A)("tabs__item",f.tabItem,i?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function y({lazy:e,children:n,selectedValue:t}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===t);return e?(0,i.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function w(e){const n=v(e);return(0,g.jsxs)("div",{className:(0,s.A)(r.G.tabs.container,"tabs-container",f.tabList),children:[(0,g.jsx)(b,{...n,...e}),(0,g.jsx)(y,{...n,...e})]})}function S(e){const n=(0,j.A)();return(0,g.jsx)(w,{...e,children:u(e.children)},String(n))}},5512:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"sdk/api-reference","title":"API Reference","description":"The SDK includes a comprehensive REST API client for accessing patient data, test results, physician-prescribed treatments, and form templates. This client handles authentication, request serialization, error handling, and automatic retry logic.","source":"@site/docs/sdk/api-reference.mdx","sourceDirName":"sdk","slug":"/sdk/api-reference","permalink":"/docs/sdk/api-reference","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"API Reference"},"sidebar":"sdkSidebar","previous":{"title":"Form Requirements","permalink":"/docs/sdk/forms"}}');var s=t(4848),r=t(8453),a=t(1470),l=t(9365);const o={sidebar_position:6,title:"API Reference"},d="API Reference",c={},h=[{value:"API Design Philosophy",id:"api-design-philosophy",level:2},{value:"API Service Initialization",id:"api-service-initialization",level:2},{value:"Patients API",id:"patients-api",level:2},{value:"Get Patient Details",id:"get-patient-details",level:3},{value:"Update Patient Details",id:"update-patient-details",level:3},{value:"Tests API",id:"tests-api",level:2},{value:"Get Tests for Patient",id:"get-tests-for-patient",level:3},{value:"Get Test Details",id:"get-test-details",level:3},{value:"Test Review Status",id:"test-review-status",level:3},{value:"Treatments API",id:"treatments-api",level:2},{value:"Get Treatment for Test",id:"get-treatment-for-test",level:3},{value:"Forms API",id:"forms-api",level:2},{value:"List Form Templates",id:"list-form-templates",level:3},{value:"Get Form Template",id:"get-form-template",level:3},{value:"List My Form Submissions",id:"list-my-form-submissions",level:3},{value:"Get Form Submission",id:"get-form-submission",level:3},{value:"Update Form Submission",id:"update-form-submission",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Common Error Codes",id:"common-error-codes",level:3},{value:"Webhook Configuration",id:"webhook-configuration",level:2},{value:"Setting Up Webhooks",id:"setting-up-webhooks",level:3},{value:"Webhook Retry Logic",id:"webhook-retry-logic",level:3},{value:"Test Review Events",id:"test-review-events",level:3},{value:"Available Webhook Events",id:"available-webhook-events",level:3},{value:"Webhook Payload Examples",id:"webhook-payload-examples",level:3},{value:"Test Review Completed",id:"test-review-completed",level:4},{value:"Test Requires Retest",id:"test-requires-retest",level:4},{value:"Form Submitted",id:"form-submitted",level:4},{value:"Treatment Updated",id:"treatment-updated",level:4},{value:"Testing Webhooks",id:"testing-webhooks",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"api-reference",children:"API Reference"})}),"\n",(0,s.jsx)(n.p,{children:"The SDK includes a comprehensive REST API client for accessing patient data, test results, physician-prescribed treatments, and form templates. This client handles authentication, request serialization, error handling, and automatic retry logic."}),"\n",(0,s.jsx)(n.h2,{id:"api-design-philosophy",children:"API Design Philosophy"}),"\n",(0,s.jsx)(n.p,{children:"The API client follows a read-only design pattern for ANS data integrity:"}),"\n",(0,s.jsx)(n.admonition,{title:"Read-Only Access",type:"note",children:(0,s.jsxs)(n.p,{children:["The API client is designed for ",(0,s.jsx)(n.strong,{children:"reading data only"}),". Critical operations like test uploads, video recording, and initial form submissions are handled internally by the SDK's test flow UI to ensure clinical validity and data integrity. You can update patient demographics and modify existing form submissions, but cannot directly upload ANS test data."]})}),"\n",(0,s.jsx)(n.p,{children:"This design ensures:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Clinical Validity"}),": Tests follow standardized protocols without modification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data Integrity"}),": ANS measurements cannot be tampered with or fabricated"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Regulatory Compliance"}),": Audit trail for all clinical data submissions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Quality Assurance"}),": Every test is validated against quality metrics"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Think of it similar to Google Maps SDK - you can read location data but cannot inject false GPS coordinates into their systems."}),"\n",(0,s.jsx)(n.h2,{id:"api-service-initialization",children:"API Service Initialization"}),"\n",(0,s.jsx)(n.p,{children:"The API service is automatically initialized when you create the SDK instance."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let sdk = AutonomicHealthSDK(\n    apiKey: "your-api-key",\n    environment: .production,\n    deviceManagers: [polarManager]\n)\n\n// Access API service\nlet apiService = sdk.apiService\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val sdk = AutonomicHealthSDK.Builder(this)\n    .apiKey("your-api-key")\n    .environment(Environment.PRODUCTION)\n    .deviceManagers(listOf(polarManager))\n    .build()\n\n// Access API service\nval apiService = sdk.apiService\n'})})})]}),"\n",(0,s.jsx)(n.h2,{id:"patients-api",children:"Patients API"}),"\n",(0,s.jsx)(n.p,{children:"The Patients API allows you to retrieve and update patient demographic information and medical history. Patient IDs are typically cached locally after initial registration, but you should never cache medical data or ANS results."}),"\n",(0,s.jsx)(n.h3,{id:"get-patient-details",children:"Get Patient Details"}),"\n",(0,s.jsx)(n.p,{children:"Retrieve complete patient information including demographics, medical history, and current medications."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'Task {\n    let patient = try await apiService.patients.getPatientDetails(\n        patientId: patientId\n    )\n    print("Patient: \\(patient.firstName) \\(patient.lastName)")\n    print("Date of birth: \\(patient.dateOfBirth)")\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'lifecycleScope.launch {\n    val patient = apiService.patients.getPatientDetails(\n        patientId = patientId\n    )\n    println("Patient: ${patient.firstName} ${patient.lastName}")\n    println("Date of birth: ${patient.dateOfBirth}")\n}\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"update-patient-details",children:"Update Patient Details"}),"\n",(0,s.jsx)(n.p,{children:"Update patient demographic information. This is useful for keeping patient records current when users change their contact information or medical history."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let updates = PatientUpdateIn(\n    firstName: "John",\n    lastName: "Doe",\n    dateOfBirth: "1980-01-15",\n    email: "john.doe@example.com"\n)\n\nlet updatedPatient = try await apiService.patients.updatePatientDetails(\n    patientId: patientId,\n    updates: updates\n)\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val updates = PatientUpdateIn(\n    firstName = "John",\n    lastName = "Doe",\n    dateOfBirth = "1980-01-15",\n    email = "john.doe@example.com"\n)\n\nval updatedPatient = apiService.patients.updatePatientDetails(\n    patientId = patientId,\n    updates = updates\n)\n'})})})]}),"\n",(0,s.jsx)(n.h2,{id:"tests-api",children:"Tests API"}),"\n",(0,s.jsx)(n.p,{children:"The Tests API provides access to historical ANS test results. Each test includes P&S metrics (RFa and LFa values in bpm\xb2), raw RR interval data, and review status. Tests go through a physician review process before treatment recommendations become available."}),"\n",(0,s.jsx)(n.h3,{id:"get-tests-for-patient",children:"Get Tests for Patient"}),"\n",(0,s.jsx)(n.p,{children:"Retrieve a paginated list of all tests for a specific patient, ordered by creation date (most recent first)."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'Task {\n    let tests = try await apiService.tests.getTestsForPatient(\n        patientId: patientId,\n        limit: 20,\n        offset: 0\n    )\n\n    for test in tests {\n        print("Test ID: \\(test.testId)")\n        print("Status: \\(test.status)")\n        print("Created: \\(test.createdAt)")\n    }\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'lifecycleScope.launch {\n    val tests = apiService.tests.getTestsForPatient(\n        patientId = patientId,\n        limit = 20,\n        offset = 0\n    )\n\n    tests.forEach { test ->\n        println("Test ID: ${test.testId}")\n        println("Status: ${test.status}")\n        println("Created: ${test.createdAt}")\n    }\n}\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"get-test-details",children:"Get Test Details"}),"\n",(0,s.jsx)(n.p,{children:"Fetch complete details for a specific test including all ANS metrics (baseline, deep breathing, Valsalva, standing), RR intervals, and review status."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let test = try await apiService.tests.getTestDetails(testId: testId)\n\nprint("Review Status: \\(test.reviewStatus)")\nprint("Baseline RFa: \\(test.results.baseline.rfa)")\nprint("Baseline LFa: \\(test.results.baseline.lfa)")\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val test = apiService.tests.getTestDetails(testId = testId)\n\nprintln("Review Status: ${test.reviewStatus}")\nprintln("Baseline RFa: ${test.results.baseline.rfa}")\nprintln("Baseline LFa: ${test.results.baseline.lfa}")\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"test-review-status",children:"Test Review Status"}),"\n",(0,s.jsx)(n.p,{children:"Tests go through a multi-stage review process before results become available:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Status"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Typical Duration"}),(0,s.jsx)(n.th,{children:"Next Steps"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pending_review"})}),(0,s.jsx)(n.td,{children:"Uploaded, awaiting physician review"}),(0,s.jsx)(n.td,{children:"0-24 hours"}),(0,s.jsx)(n.td,{children:"Test is queued for review"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"under_review"})}),(0,s.jsx)(n.td,{children:"Physician currently reviewing"}),(0,s.jsx)(n.td,{children:"1-48 hours"}),(0,s.jsx)(n.td,{children:"Provider analyzing data and video"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"reviewed"})}),(0,s.jsx)(n.td,{children:"Review complete, treatment available"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsx)(n.td,{children:"Fetch treatment via Treatments API"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"requires_retest"})}),(0,s.jsx)(n.td,{children:"Test invalid, retest needed"}),(0,s.jsx)(n.td,{children:"N/A"}),(0,s.jsxs)(n.td,{children:["Check ",(0,s.jsx)(n.code,{children:"reviewFeedback"})," for rejection reasons"]})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Review Feedback Reasons:"}),"\nWhen a test status is ",(0,s.jsx)(n.code,{children:"requires_retest"}),", the ",(0,s.jsx)(n.code,{children:"reviewFeedback"})," array contains specific reasons:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"excessive_movement"})," - Too much fidgeting or motion artifacts during baseline/breathing phases"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"poor_valsalva_technique"})," - Insufficient pressure during Valsalva maneuver"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"device_disconnection"})," - Heart rate monitor lost connection during critical phases"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"non_compliance"})," - User did not follow instructions (e.g., talking, using phone, standing early)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"insufficient_data"})," - RR interval data quality too low for analysis"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"companion_not_present"})," - Another adult not visible in video (safety requirement)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"video_quality_poor"})," - Video too dark or obstructed to verify test validity"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"Webhook Integration",type:"tip",children:(0,s.jsxs)(n.p,{children:["Configure webhooks to receive ",(0,s.jsx)(n.strong,{children:"real-time notifications"})," when test review status changes. This provides better UX than polling the API every few minutes. See ",(0,s.jsx)(n.a,{href:"#webhook-configuration",children:"Webhook Configuration"})," below for setup instructions."]})}),"\n",(0,s.jsx)(n.h2,{id:"treatments-api",children:"Treatments API"}),"\n",(0,s.jsx)(n.p,{children:"The Treatments API provides access to physician-prescribed treatment plans. Treatments are created by licensed healthcare providers after reviewing ANS test results and include diagnosis, lifestyle recommendations, medications, and supplements."}),"\n",(0,s.jsx)(n.h3,{id:"get-treatment-for-test",children:"Get Treatment for Test"}),"\n",(0,s.jsx)(n.p,{children:"Retrieve the treatment plan associated with a reviewed test. Treatment plans include diagnosis codes, clinical recommendations, prescribed medications with dosages, and supplement suggestions."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'Task {\n    let treatment = try await apiService.treatments.getTreatmentForTest(\n        testId: testId\n    )\n\n    print("Diagnosis: \\(treatment.diagnosis)")\n    print("Recommendations: \\(treatment.recommendations)")\n\n    for medication in treatment.medications {\n        print("Medication: \\(medication.name) - \\(medication.dosage)")\n    }\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'lifecycleScope.launch {\n    val treatment = apiService.treatments.getTreatmentForTest(\n        testId = testId\n    )\n\n    println("Diagnosis: ${treatment.diagnosis}")\n    println("Recommendations: ${treatment.recommendations}")\n\n    treatment.medications.forEach { medication ->\n        println("Medication: ${medication.name} - ${medication.dosage}")\n    }\n}\n'})})})]}),"\n",(0,s.jsx)(n.admonition,{title:"Treatment Availability",type:"note",children:(0,s.jsxs)(n.p,{children:["Treatments are only available after a test has been reviewed by a physician (",(0,s.jsx)(n.code,{children:"reviewStatus: reviewed"}),")."]})}),"\n",(0,s.jsx)(n.h2,{id:"forms-api",children:"Forms API"}),"\n",(0,s.jsx)(n.p,{children:"The Forms API provides access to questionnaire templates and patient form submissions. Forms are required before conducting ANS tests and include the 28-Symptom Autonomic Questionnaire\u2122, medical history, current medications, and lifestyle factors."}),"\n",(0,s.jsx)(n.h3,{id:"list-form-templates",children:"List Form Templates"}),"\n",(0,s.jsx)(n.p,{children:"Retrieve all available form templates. This typically includes the required autonomic symptom questionnaire and optional supplementary forms."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let templates = try await apiService.forms.listFormTemplates()\n\nfor template in templates {\n    print("Form: \\(template.name)")\n    print("ID: \\(template.formId)")\n    print("Required: \\(template.required)")\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val templates = apiService.forms.listFormTemplates()\n\ntemplates.forEach { template ->\n    println("Form: ${template.name}")\n    println("ID: ${template.formId}")\n    println("Required: ${template.required}")\n}\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"get-form-template",children:"Get Form Template"}),"\n",(0,s.jsx)(n.p,{children:"Fetch a specific form template with all questions, input types, and validation rules. Use this to build custom form UIs or pre-populate forms with existing data."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let form = try await apiService.forms.getFormTemplate(\n    formId: "28-symptom-autonomic"\n)\n\nfor question in form.questions {\n    print("Question: \\(question.text)")\n    print("Type: \\(question.inputType)")\n    print("Options: \\(question.options)")\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val form = apiService.forms.getFormTemplate(\n    formId = "28-symptom-autonomic"\n)\n\nform.questions.forEach { question ->\n    println("Question: ${question.text}")\n    println("Type: ${question.inputType}")\n    println("Options: ${question.options}")\n}\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"list-my-form-submissions",children:"List My Form Submissions"}),"\n",(0,s.jsx)(n.p,{children:"Retrieve all form submissions for a patient, optionally filtered by form type. Useful for displaying submission history or checking if required forms are completed."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let submissions = try await apiService.forms.listMyFormSubmissions(\n    patientId: patientId,\n    formId: "28-symptom-autonomic"\n)\n\nfor submission in submissions {\n    print("Submission ID: \\(submission.submissionId)")\n    print("Status: \\(submission.status)")\n    print("Submitted: \\(submission.submittedAt)")\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val submissions = apiService.forms.listMyFormSubmissions(\n    patientId = patientId,\n    formId = "28-symptom-autonomic"\n)\n\nsubmissions.forEach { submission ->\n    println("Submission ID: ${submission.submissionId}")\n    println("Status: ${submission.status}")\n    println("Submitted: ${submission.submittedAt}")\n}\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"get-form-submission",children:"Get Form Submission"}),"\n",(0,s.jsx)(n.p,{children:"Fetch a specific form submission with all responses. This is useful for displaying completed forms or allowing users to review their previous answers."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let submission = try await apiService.forms.getMyFormSubmission(\n    submissionId: submissionId\n)\n\nprint("Form ID: \\(submission.formId)")\nprint("Status: \\(submission.status)")\n\nfor (questionId, answer) in submission.responses {\n    print("\\(questionId): \\(answer)")\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val submission = apiService.forms.getMyFormSubmission(\n    submissionId = submissionId\n)\n\nprintln("Form ID: ${submission.formId}")\nprintln("Status: ${submission.status}")\n\nsubmission.responses.forEach { (questionId, answer) ->\n    println("$questionId: $answer")\n}\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"update-form-submission",children:"Update Form Submission"}),"\n",(0,s.jsx)(n.p,{children:"Update an existing form submission with new or modified responses. This allows users to correct mistakes or update information (e.g., medication changes) before test review."}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let updatedResponses: [String: AnyCodable] = [\n    "q1_dizziness": AnyCodable("4"),\n    "q2_medications": AnyCodable("Updated medication list")\n]\n\nlet update = FormSubmissionUpdate(\n    responses: updatedResponses,\n    status: .completed\n)\n\nlet updated = try await apiService.forms.updateMyFormSubmission(\n    submissionId: submissionId,\n    update: update\n)\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val updatedResponses = mapOf(\n    "q1_dizziness" to "4",\n    "q2_medications" to "Updated medication list"\n)\n\nval update = FormSubmissionUpdate(\n    responses = updatedResponses,\n    status = FormStatus.COMPLETED\n)\n\nval updated = apiService.forms.updateMyFormSubmission(\n    submissionId = submissionId,\n    update = update\n)\n'})})})]}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'Task {\n    do {\n        let patient = try await apiService.patients.getPatientDetails(\n            patientId: patientId\n        )\n    } catch APIError.unauthorized {\n        print("Invalid or expired API key")\n    } catch APIError.notFound {\n        print("Patient not found")\n    } catch APIError.rateLimitExceeded {\n        print("Too many requests, try again later")\n    } catch {\n        print("Unexpected error: \\(error)")\n    }\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'lifecycleScope.launch {\n    try {\n        val patient = apiService.patients.getPatientDetails(\n            patientId = patientId\n        )\n    } catch (e: APIError.Unauthorized) {\n        println("Invalid or expired API key")\n    } catch (e: APIError.NotFound) {\n        println("Patient not found")\n    } catch (e: APIError.RateLimitExceeded) {\n        println("Too many requests, try again later")\n    } catch (e: Exception) {\n        println("Unexpected error: ${e.message}")\n    }\n}\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"common-error-codes",children:"Common Error Codes"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"401"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"unauthorized"})}),(0,s.jsx)(n.td,{children:"Invalid or expired API key"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"403"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"forbidden"})}),(0,s.jsx)(n.td,{children:"Insufficient permissions"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"404"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"not_found"})}),(0,s.jsx)(n.td,{children:"Resource not found"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"429"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"rate_limit_exceeded"})}),(0,s.jsx)(n.td,{children:"Too many requests"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"500"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"internal_error"})}),(0,s.jsx)(n.td,{children:"Server error"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"webhook-configuration",children:"Webhook Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Webhooks provide real-time notifications for important events like test reviews completing or treatment plans being updated. Configure webhook endpoints in the ",(0,s.jsx)(n.a,{href:"https://developers.autonomichealth.ai",children:"Developer Portal"})," to receive these notifications."]}),"\n",(0,s.jsxs)(n.admonition,{title:"Use Webhooks for Real-Time Updates",type:"tip",children:[(0,s.jsx)(n.p,{children:"Instead of polling the API to check if a test review is complete, configure a webhook to receive instant notifications. This reduces API calls and provides better user experience."}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example:"})," When a physician completes a test review, you'll receive a webhook within seconds, allowing you to immediately notify the user via push notification that their results are ready."]})]}),"\n",(0,s.jsx)(n.h3,{id:"setting-up-webhooks",children:"Setting Up Webhooks"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1. Create a Webhook Endpoint"})}),"\n",(0,s.jsx)(n.p,{children:"Your backend must expose an HTTPS endpoint that can receive POST requests:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"POST https://your-api.example.com/webhooks/autonomic-health\nContent-Type: application/json\nX-AH-Signature: sha256=abc123...\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"2. Configure in Developer Portal"})}),"\n",(0,s.jsxs)(n.p,{children:["Navigate to ",(0,s.jsx)(n.a,{href:"https://developers.autonomichealth.ai",children:"Developer Portal"})," \u2192 Webhooks \u2192 Add Endpoint:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Endpoint URL"}),": Your HTTPS endpoint (must use TLS 1.2+)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Events"}),": Select which events to receive (test reviews, form submissions, etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Secret Key"}),": Copy your webhook secret for signature verification"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"3. Verify Signatures"})}),"\n",(0,s.jsxs)(n.p,{children:["All webhook payloads include an ",(0,s.jsx)(n.code,{children:"X-AH-Signature"})," header for security:"]}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS (Backend)",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'import CryptoKit\n\nfunc verifyWebhookSignature(payload: Data, signature: String, secret: String) -> Bool {\n    let hmac = HMAC<SHA256>.authenticationCode(for: payload, using: SymmetricKey(data: Data(secret.utf8)))\n    let computedSignature = "sha256=" + hmac.map { String(format: "%02x", $0) }.joined()\n    return computedSignature == signature\n}\n\n// In your webhook handler\nfunc handleWebhook(request: HTTPRequest) throws {\n    guard let signature = request.headers["X-AH-Signature"] else {\n        throw WebhookError.missingSignature\n    }\n\n    let payload = request.body\n    let isValid = verifyWebhookSignature(\n        payload: payload,\n        signature: signature,\n        secret: webhookSecret\n    )\n\n    guard isValid else {\n        throw WebhookError.invalidSignature\n    }\n\n    // Process webhook payload\n    let event = try JSONDecoder().decode(WebhookEvent.self, from: payload)\n    processWebhookEvent(event)\n}\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android (Backend)",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'import javax.crypto.Mac\nimport javax.crypto.spec.SecretKeySpec\n\nfun verifyWebhookSignature(payload: ByteArray, signature: String, secret: String): Boolean {\n    val mac = Mac.getInstance("HmacSHA256")\n    mac.init(SecretKeySpec(secret.toByteArray(), "HmacSHA256"))\n    val computedHmac = mac.doFinal(payload)\n    val computedSignature = "sha256=" + computedHmac.joinToString("") { "%02x".format(it) }\n    return computedSignature == signature\n}\n\n// In your webhook handler\nfun handleWebhook(request: HttpRequest) {\n    val signature = request.headers["X-AH-Signature"]\n        ?: throw WebhookException("Missing signature")\n\n    val payload = request.body\n    val isValid = verifyWebhookSignature(\n        payload = payload,\n        signature = signature,\n        secret = webhookSecret\n    )\n\n    if (!isValid) {\n        throw WebhookException("Invalid signature")\n    }\n\n    // Process webhook payload\n    val event = Json.decodeFromString<WebhookEvent>(payload.decodeToString())\n    processWebhookEvent(event)\n}\n'})})})]}),"\n",(0,s.jsxs)(n.admonition,{title:"Security: Always Verify Signatures",type:"warning",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Never"})," process webhook payloads without verifying the HMAC signature. An attacker could send fake webhook events to your endpoint, potentially causing your app to display incorrect test results or send false notifications to users."]}),(0,s.jsx)(n.p,{children:"The signature verification ensures the payload came from Autonomic Health and hasn't been tampered with."})]}),"\n",(0,s.jsx)(n.h3,{id:"webhook-retry-logic",children:"Webhook Retry Logic"}),"\n",(0,s.jsx)(n.p,{children:"If your endpoint is unreachable or returns a non-2xx status code, the webhook system automatically retries:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Retry Schedule"}),": Exponential backoff (1 min, 5 min, 15 min, 1 hour, 6 hours, 24 hours)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Max Retries"}),": 6 attempts over 24 hours"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Timeout"}),": 30 seconds per request"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Failed Delivery"}),": After max retries, webhook is marked as failed and you'll receive an email alert"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Respond with ",(0,s.jsx)(n.code,{children:"200 OK"})," immediately after receiving the webhook"]}),"\n",(0,s.jsx)(n.li,{children:"Process the payload asynchronously in a background job"}),"\n",(0,s.jsx)(n.li,{children:"If processing fails, the webhook won't be retried (you'll need to poll the API)"}),"\n",(0,s.jsx)(n.li,{children:"Log all webhook receipts for debugging"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Idempotency:"}),"\nWebhooks may be delivered more than once due to network issues or retries. Your handler should be idempotent:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'func processWebhookEvent(_ event: WebhookEvent) async throws {\n    // Check if this event was already processed\n    if await database.webhookEventExists(eventId: event.id) {\n        print("Duplicate webhook, skipping")\n        return\n    }\n\n    // Mark as processed before handling\n    await database.saveWebhookEvent(eventId: event.id, timestamp: Date())\n\n    // Now process the event\n    switch event.type {\n    case .testReviewCompleted:\n        await notifyUserTestComplete(event.testId)\n    case .formSubmitted:\n        await checkIfAllFormsComplete(event.patientId)\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"test-review-events",children:"Test Review Events"}),"\n",(0,s.jsxs)(a.A,{groupId:"platform",children:[(0,s.jsx)(l.A,{value:"ios",label:"iOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'// Webhook payload structure\nstruct TestReviewWebhook: Codable {\n    let event: String // "test.review.completed"\n    let testId: String\n    let patientId: String\n    let reviewStatus: String\n    let timestamp: String\n}\n\n// Handle webhook in your backend\n// POST /webhooks/autonomic-health\n// {\n//   "event": "test.review.completed",\n//   "testId": "test_abc123",\n//   "patientId": "patient_xyz789",\n//   "reviewStatus": "reviewed",\n//   "timestamp": "2024-01-15T10:30:00Z"\n// }\n'})})}),(0,s.jsx)(l.A,{value:"android",label:"Android",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// Webhook payload structure\ndata class TestReviewWebhook(\n    val event: String, // "test.review.completed"\n    val testId: String,\n    val patientId: String,\n    val reviewStatus: String,\n    val timestamp: String\n)\n\n// Handle webhook in your backend\n// POST /webhooks/autonomic-health\n// {\n//   "event": "test.review.completed",\n//   "testId": "test_abc123",\n//   "patientId": "patient_xyz789",\n//   "reviewStatus": "reviewed",\n//   "timestamp": "2024-01-15T10:30:00Z"\n// }\n'})})})]}),"\n",(0,s.jsx)(n.h3,{id:"available-webhook-events",children:"Available Webhook Events"}),"\n",(0,s.jsx)(n.p,{children:"Configure which events you want to receive in the Developer Portal. Each event includes relevant identifiers to fetch fresh data via the API."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Event"}),(0,s.jsx)(n.th,{children:"Trigger"}),(0,s.jsx)(n.th,{children:"Typical Use Case"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"test.upload.completed"})}),(0,s.jsx)(n.td,{children:"Test data and video uploaded successfully"}),(0,s.jsx)(n.td,{children:'Update UI to show "Processing..."'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"test.review.started"})}),(0,s.jsx)(n.td,{children:"Physician begins reviewing test"}),(0,s.jsx)(n.td,{children:"Update status in app"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"test.review.completed"})}),(0,s.jsx)(n.td,{children:"Review complete, treatment available"}),(0,s.jsx)(n.td,{children:'Send push notification: "Your results are ready!"'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"test.requires_retest"})}),(0,s.jsx)(n.td,{children:"Test invalid, retest needed"}),(0,s.jsx)(n.td,{children:"Notify user with specific feedback"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"form.submitted"})}),(0,s.jsx)(n.td,{children:"Patient completes a form"}),(0,s.jsx)(n.td,{children:"Check if all required forms are now complete"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"form.updated"})}),(0,s.jsx)(n.td,{children:"Patient modifies an existing form submission"}),(0,s.jsx)(n.td,{children:"Trigger re-analysis if test already reviewed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"treatment.created"})}),(0,s.jsx)(n.td,{children:"New treatment plan created for patient"}),(0,s.jsx)(n.td,{children:'Notify user: "Your treatment plan is ready"'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"treatment.updated"})}),(0,s.jsx)(n.td,{children:"Physician modifies treatment plan"}),(0,s.jsx)(n.td,{children:"Alert user about dosage changes or new recommendations"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"webhook-payload-examples",children:"Webhook Payload Examples"}),"\n",(0,s.jsx)(n.h4,{id:"test-review-completed",children:"Test Review Completed"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event": "test.review.completed",\n  "event_id": "evt_abc123xyz",\n  "timestamp": "2024-01-15T14:30:00Z",\n  "data": {\n    "test_id": "test_550e8400-e29b-41d4-a716-446655440000",\n    "patient_id": "patient_7c9e6679-7425-40de-944b-e07fc1f90ae7",\n    "review_status": "reviewed",\n    "reviewer_id": "provider_123",\n    "reviewed_at": "2024-01-15T14:29:45Z",\n    "treatment_available": true\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response Flow:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Receive webhook"}),"\n",(0,s.jsx)(n.li,{children:"Verify HMAC signature"}),"\n",(0,s.jsxs)(n.li,{children:["Fetch test details: ",(0,s.jsx)(n.code,{children:"GET /tests/{test_id}"})]}),"\n",(0,s.jsxs)(n.li,{children:["Fetch treatment: ",(0,s.jsx)(n.code,{children:"GET /treatments/by-test/{test_id}"})]}),"\n",(0,s.jsx)(n.li,{children:"Send push notification to user"}),"\n",(0,s.jsx)(n.li,{children:'Update app UI to show "Results Available"'}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"test-requires-retest",children:"Test Requires Retest"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event": "test.requires_retest",\n  "event_id": "evt_def456uvw",\n  "timestamp": "2024-01-15T10:15:00Z",\n  "data": {\n    "test_id": "test_660f9511-f39c-52e5-b827-557766551111",\n    "patient_id": "patient_8d0f7789-8536-51ef-055c-f18gd2g01bf8",\n    "review_status": "requires_retest",\n    "reviewer_id": "provider_456",\n    "reviewed_at": "2024-01-15T10:14:30Z",\n    "review_feedback": [\n      "excessive_movement",\n      "poor_valsalva_technique"\n    ],\n    "reviewer_notes": "Patient moved frequently during baseline. Valsalva pressure insufficient."\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response Flow:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Receive webhook"}),"\n",(0,s.jsx)(n.li,{children:"Verify signature"}),"\n",(0,s.jsx)(n.li,{children:"Fetch full test details with feedback"}),"\n",(0,s.jsx)(n.li,{children:'Send push notification: "Your test needs to be retaken"'}),"\n",(0,s.jsx)(n.li,{children:"In-app message explaining what went wrong with tips for next attempt"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"form-submitted",children:"Form Submitted"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event": "form.submitted",\n  "event_id": "evt_ghi789rst",\n  "timestamp": "2024-01-14T16:45:00Z",\n  "data": {\n    "submission_id": "sub_771g0622-g40d-63f6-c938-668877662222",\n    "form_id": "28-symptom-autonomic",\n    "patient_id": "patient_8d0f7789-8536-51ef-055c-f18gd2g01bf8",\n    "status": "completed",\n    "submitted_at": "2024-01-14T16:44:55Z"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response Flow:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Receive webhook"}),"\n",(0,s.jsx)(n.li,{children:"Check if all required forms are now complete"}),"\n",(0,s.jsxs)(n.li,{children:["If complete and test is ",(0,s.jsx)(n.code,{children:"pending_forms"}),", trigger test review"]}),"\n",(0,s.jsx)(n.li,{children:'Update UI to enable "Start Test" button if forms were blocking'}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"treatment-updated",children:"Treatment Updated"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "event": "treatment.updated",\n  "event_id": "evt_jkl012mno",\n  "timestamp": "2024-01-16T09:20:00Z",\n  "data": {\n    "treatment_id": "tx_882h1733-h51e-74g7-d049-779988773333",\n    "patient_id": "patient_9e1g8890-9647-62fg-166d-g29he3h12cg9",\n    "test_id": "test_550e8400-e29b-41d4-a716-446655440000",\n    "updated_at": "2024-01-16T09:19:45Z",\n    "updated_by": "provider_789",\n    "changes": [\n      "medications_modified",\n      "dosage_adjusted"\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response Flow:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Receive webhook"}),"\n",(0,s.jsx)(n.li,{children:"Fetch updated treatment plan"}),"\n",(0,s.jsx)(n.li,{children:'Send push notification: "Your treatment plan has been updated"'}),"\n",(0,s.jsx)(n.li,{children:"In-app badge/indicator on Treatment tab"}),"\n",(0,s.jsx)(n.li,{children:"Optionally email patient about changes"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"testing-webhooks",children:"Testing Webhooks"}),"\n",(0,s.jsx)(n.p,{children:"The Developer Portal provides a webhook testing tool:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Send test events to your endpoint"}),"\n",(0,s.jsx)(n.li,{children:"View delivery logs and responses"}),"\n",(0,s.jsx)(n.li,{children:"Inspect retry attempts"}),"\n",(0,s.jsx)(n.li,{children:"Validate signature verification"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Development Tips:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use services like ",(0,s.jsx)(n.a,{href:"https://ngrok.com",children:"ngrok"})," to expose localhost during development"]}),"\n",(0,s.jsx)(n.li,{children:"Test all event types before going to production"}),"\n",(0,s.jsx)(n.li,{children:"Verify your idempotency logic with duplicate deliveries"}),"\n",(0,s.jsx)(n.li,{children:"Test signature verification with invalid signatures"}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{title:"Production Readiness Checklist",type:"caution",children:[(0,s.jsx)(n.p,{children:"Before enabling webhooks in production:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 HTTPS endpoint with valid TLS certificate (TLS 1.2+)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Signature verification implemented and tested"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Idempotency handling for duplicate events"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Asynchronous processing (respond 200 immediately)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Error logging and monitoring"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Graceful degradation if webhook processing fails"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Tested with all event types you subscribed to"}),"\n"]})]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var i=t(6540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},9365:(e,n,t)=>{t.d(n,{A:()=>a});t(6540);var i=t(4164);const s={tabItem:"tabItem_Ymn6"};var r=t(4848);function a({children:e,hidden:n,className:t}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.A)(s.tabItem,t),hidden:n,children:e})}}}]);